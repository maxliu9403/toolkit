# 调试指南

## 如果上传Excel没有生效

### 1. 检查浏览器控制台

1. 打开浏览器（推荐使用Chrome或Firefox）
2. 访问 `http://localhost:8800`
3. 按 `F12` 或右键点击页面 -> "检查" 打开开发者工具
4. 切换到 "Console（控制台）" 标签页
5. 尝试上传文件，查看控制台输出

### 2. 预期的控制台输出

**点击上传封号数据表时：**
```
封号数据表文件选择事件触发 FileList {...}
处理封号数据表文件: xxx.xlsx
封号数据表文件已设置
```

**点击上传目标文件时：**
```
目标文件选择事件触发 FileList {...}
处理目标文件: 1 个文件
添加目标文件: xxx.xlsx
当前目标文件总数: 1
```

### 3. 常见问题

#### 问题1: 点击上传区域没有反应

**可能原因：**
- JavaScript未加载完成
- 元素ID不匹配
- 事件监听器未正确绑定

**解决方法：**
1. 刷新页面（Ctrl+F5 或 Cmd+Shift+R 强制刷新）
2. 检查控制台是否有错误信息
3. 确认页面完全加载完成后再点击

#### 问题2: 文件选择对话框不弹出

**可能原因：**
- 浏览器阻止了文件选择对话框
- input元素未正确设置

**解决方法：**
1. 检查浏览器是否有弹窗拦截
2. 尝试手动拖拽文件到上传区域
3. 查看控制台是否有JavaScript错误

#### 问题3: 文件选择后没有显示

**可能原因：**
- 文件格式不支持（必须是.xlsx或.xls）
- JavaScript渲染函数出错

**解决方法：**
1. 确认文件格式正确
2. 查看控制台是否有错误信息
3. 检查文件列表区域的HTML是否正确渲染

### 4. 手动测试步骤

1. **测试封号数据表上传：**
   ```javascript
   // 在浏览器控制台输入：
   document.getElementById('banFileInput').click()
   ```
   应该会打开文件选择对话框

2. **测试目标文件上传：**
   ```javascript
   // 在浏览器控制台输入：
   document.getElementById('targetFileInput').click()
   ```
   应该会打开文件选择对话框

3. **检查事件监听器：**
   ```javascript
   // 在浏览器控制台输入：
   console.log('banFile:', banFile);
   console.log('targetFiles:', targetFiles);
   ```
   可以查看当前已选择的文件

### 5. 拖拽上传测试

如果点击上传不工作，尝试拖拽上传：

1. 打开文件管理器
2. 选择Excel文件
3. 拖拽到对应的上传区域
4. 查看控制台输出

### 6. 浏览器兼容性

推荐使用以下浏览器：
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

### 7. 清除缓存

如果问题持续存在，尝试清除浏览器缓存：

1. Chrome/Edge: Ctrl+Shift+Delete (Windows) 或 Cmd+Shift+Delete (Mac)
2. 选择"缓存的图片和文件"
3. 点击"清除数据"
4. 重新加载页面

### 8. 联系支持

如果以上方法都无法解决问题，请提供：
1. 浏览器类型和版本
2. 操作系统
3. 控制台错误信息截图
4. 详细的操作步骤描述

